"use strict";var T=Object.create;var d=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var C=(t,e)=>{for(var r in e)d(t,r,{get:e[r],enumerable:!0})},$=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of _(e))!U.call(t,l)&&l!==r&&d(t,l,{get:()=>e[l],enumerable:!(a=R(e,l))||a.enumerable});return t};var y=(t,e,r)=>(r=t!=null?T(P(t)):{},$(e||!t||!t.__esModule?d(r,"default",{value:t,enumerable:!0}):r,t)),I=t=>$(d({},"__esModule",{value:!0}),t);var z={};C(z,{default:()=>A});module.exports=I(z);var c=require("@raycast/api");var s=require("@raycast/api");var o=y(require("react")),n=require("@raycast/api");var w=require("react/jsx-runtime");var i=require("fs");var k=require("path");var m=y(require("node:os"),1),u,h;function b(t){if(typeof t!="string")throw new TypeError(`Expected a string, got ${typeof t}`);if(u===void 0&&(u=m.default.homedir()),u&&/^~(?=$|\/|\\)/.test(t))return t.replace(/^~/,u);let e=t.match(/^~([^/\\]+)(.*)/);if(e&&(h===void 0&&(h=m.default.userInfo().username),h)){let r=e[1],a=e[2];if(r===h)return u+a}return t}var L=require("react/jsx-runtime"),f=(0,s.getPreferenceValues)(),g=b(f.downloadsFolder??"~/Downloads"),O=f.showHiddenFiles,D=f.fileOrder,p=f.lastestDownloadOrder,J=f.downloadsLayout??"list";function M(){return(0,i.readdirSync)(g).filter(e=>O||!e.startsWith(".")).map(e=>{let r=(0,k.join)(g,e);try{let a=(0,i.statSync)(r);return{file:e,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}catch(a){console.warn(`Skipping '${r}' because it could not be stat'd:`,a);return}}).filter(e=>!!e).map(e=>e).sort((e,r)=>{switch(D){case"addTime":return r.addedAt.getTime()-e.addedAt.getTime();case"createTime":return r.createdAt.getTime()-e.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-e.lastModifiedAt.getTime()}})}function x(){let t=M();if(!(t.length<1))return p==="addTime"?t.sort((e,r)=>r.addedAt.getTime()-e.addedAt.getTime()):p==="createTime"?t.sort((e,r)=>r.createdAt.getTime()-e.createdAt.getTime()):p==="modifiedTime"?t.sort((e,r)=>r.lastModifiedAt.getTime()-e.lastModifiedAt.getTime()):p==="birthTime"&&t.sort((e,r)=>r.birthAt.getTime()-e.birthAt.getTime()),t[0]}function v(){try{return(0,i.accessSync)(g,i.constants.R_OK),!0}catch(t){return console.error(t),!1}}var S=require("@raycast/api"),E=require("@raycast/api");async function A(){if(!v()){await(0,c.showHUD)("No permission to access the downloads folder");return}let t=x();if(!t){await(0,c.showHUD)("No downloads found");return}await S.Clipboard.copy({file:t.path}),await(0,E.closeMainWindow)(),await(0,c.showHUD)("Copied latest download to clipboard"),await(0,c.popToRoot)()}
